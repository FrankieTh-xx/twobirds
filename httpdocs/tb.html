<html>
    <head>
        <title>tb test</title>
        <script src="tb/tb.js"></script>
        <script>

            tb.namespace( 'app', true ).GrandParent = (function(){

                // Constructor
                function GrandParent( pConfig ){
                    var that = this;

                    that.handlers = {
                        init,
                        test
                    };

                }

                // Prototype
                GrandParent.prototype = {

                    namespace: 'app.GrandParent',

                    'tb.require': [
                        '/demoapp/test.js',
                        '/demoapp/test.json',
                        '/demoapp/test.css',
                        '/demoapp/test.html'
                    ]

                };

                return GrandParent;

                // Methods
                function init( e ){
                    var that = this;

                    for ( var x=0; x < 5; x++ ) {
                        new tb(
                            app.Parent,
                            {},
                            that.target.appendChild( document.createElement("div") )
                        );
                    }
                }

                function test( e ){
                    var that = this;

                    console.info( 'Handler "test" in: ', that.target, 'sender: ',  e );
                }

            })();



            tb.namespace( 'app', true ).Parent = (function(){

                // Constructor
                function Parent( pConfig ){
                    var that = this;

                    that.handlers = {
                        init
                    };

                }

                // Prototype
                Parent.prototype = {
                    namespace: 'app.Parent'
                };

                return Parent;

                // Methods
                function init( e ){
                    var that = this;

                    for ( var i=0; i<10; i++ ){
                        new tb(
                            app.Child,
                            {},
                            that.target.appendChild( document.createElement("div") )
                        );
                    }
                }

            })();


            // simple objects...
            app.EmbeddedObject1 = function EmbeddedObject1( pConfig ){
            };

            app.EmbeddedObject1.prototype = {
                namespace: 'app.EmbeddedObject1',
                'app.EmbeddedObject2': {}
            };

            app.EmbeddedObject2 = function EmbeddedObject2( pConfig ){
                var that = this;

                that.handlers = {
                    'init': function( e ){
                        that.trigger( 'test', that, 'u');
                    }
                }
            };

            app.EmbeddedObject2.prototype = {
                namespace: 'app.EmbeddedObject2'
            };






            tb.namespace( 'app', true ).Child = (function(){

                // Constructor
                function Child( pConfig ){
                    var that = this;

                    that.handlers = {
                        init,
                        test
                    };

                }

                // Prototype
                Child.prototype = {
                    namespace: 'app.Child',
                    'app.EmbeddedObject1': {}
                };

                return Child;

                // Methods
                function init( e ){
                    var that = this;

                    for ( var i=0; i<3; i++ ){
                        new tb(
                            app.GrandChild,
                            {},
                            that.target.appendChild( document.createElement("div") )
                        );
                    }
                }

                function test( e ){
                    var that = this;

                    if ( e.data.namespace === 'app.EmbeddedObject2' ){
                        e.stopPropagation();
                    }
                    console.info( 'Handler "test" in:', that.target, 'sender: ', e );
                }

            })();






            tb.namespace( 'app', true ).GrandChild = (function(){

                // Constructor
                function GrandChild( pConfig ){
                    var that = this;

                    that.handlers = {
                        init
                    };

                }

                // Prototype
                GrandChild.prototype = {
                    namespace: 'app.GrandChild'
                };

                return GrandChild;

                // Methods
                function init( e ){
                    var that = this;

                    for ( var i=0; i<2; i++ ){
                        new tb(
                            app.GreatGrandChild,
                            {},
                            that.target.appendChild( document.createElement("div") )
                        );
                    }
                }

            })();



            tb.namespace( 'app', true ).GreatGrandChild = (function(){

                // Constructor
                function GreatGrandChild( pConfig ){
                    var that = this;

                    that.handlers = {
                        init
                    };

                }

                // Prototype
                GreatGrandChild.prototype = {
                    namespace: 'app.GreatGrandChild'
                };

                return GreatGrandChild;

                // Methods
                function init( e ){
                    var that = this;

                    //that.trigger( 'test', that, 'u' );
                }

            })();


        </script>
    </head>
    <body data-tb="app.GrandParent">
    </body>
</html>
